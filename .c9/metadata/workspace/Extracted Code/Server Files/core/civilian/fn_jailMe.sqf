{"filter":false,"title":"fn_jailMe.sqf","tooltip":"/Extracted Code/Server Files/core/civilian/fn_jailMe.sqf","undoManager":{"mark":0,"position":0,"stack":[[{"group":"doc","deltas":[{"start":{"row":0,"column":0},"end":{"row":81,"column":2},"action":"remove","lines":["/*","\tFile: fn_jailMe.sqf","\tAuthor Bryan \"Tonic\" Boardwine","\t","\tDescription:","\tOnce word is received by the server the rest of the jail execution is completed.","*/","private[\"_ret\",\"_bad\",\"_time\",\"_bail\",\"_esc\",\"_countDown\"];","_ret = [_this,0,[],[[]]] call BIS_fnc_param;","_bad = [_this,1,false,[false]] call BIS_fnc_param;","if(_bad) then { _time = time + 1100; } else { _time = time + (15 * 60); };","","if(count _ret > 0) then { life_bail_amount = (_ret select 3); } else { life_bail_amount = 1500; _time = time + (10 * 60); };","_esc = false;","_bail = false;","","[_bad] spawn","{","\tlife_canpay_bail = false;","\tif(_this select 0) then","\t{","\t\tsleep (10 * 60);","\t}","\t\telse","\t{","\t\tsleep (5 * 60);","\t};","\tlife_canpay_bail = nil;","};","","while {true} do","{","\tif((round(_time - time)) > 0) then {","\t\t_countDown = [(_time - time),\"MM:SS.MS\"] call BIS_fnc_secondsToString;","\t\thintSilent parseText format[(localize \"STR_Jail_Time\")+ \"<br/> <t size='2'><t color='#FF0000'>%1</t></t><br/><br/>\" +(localize \"STR_Jail_Pay\")+ \" %3<br/>\" +(localize \"STR_Jail_Price\")+ \" $%2\",_countDown,[life_bail_amount] call life_fnc_numberText,if(isNil \"life_canpay_bail\") then {\"Yes\"} else {\"No\"}];","\t};","\t","\tif(player distance (getMarkerPos \"jail_marker\") > 60) exitWith {","\t\t_esc = true;","\t};","\t","\tif(life_bail_paid) exitWith {","\t\t_bail = true;","\t};","\t","\tif((round(_time - time)) < 1) exitWith {hint \"\"};","\tif(!alive player && ((round(_time - time)) > 0)) exitWith {};","\tsleep 0.1;","};","","","switch (true) do","{","\tcase (_bail) :","\t{","\t\tlife_is_arrested = false;","\t\tlife_bail_paid = false;","\t\thint localize \"STR_Jail_Paid\";","\t\tserv_wanted_remove = [player];","\t\tplayer setPos (getMarkerPos \"jail_release\");","\t\t[[getPlayerUID player],\"life_fnc_wantedRemove\",false,false] spawn life_fnc_MP;","\t\t[5] call SOCK_fnc_updatePartial;","\t};","\t","\tcase (_esc) :","\t{","\t\tlife_is_arrested = false;","\t\thint localize \"STR_Jail_EscapeSelf\";","\t\t[[0,\"STR_Jail_EscapeNOTF\",true,[profileName]],\"life_fnc_broadcast\",nil,false] spawn life_fnc_MP;","\t\t[[getPlayerUID player,profileName,\"901\"],\"life_fnc_wantedAdd\",false,false] spawn life_fnc_MP;","\t\t[5] call SOCK_fnc_updatePartial;","\t};","\t","\tcase (alive player && !_esc && !_bail) :","\t{","\t\tlife_is_arrested = false;","\t\thint localize \"STR_Jail_Released\";","\t\t[[getPlayerUID player],\"life_fnc_wantedRemove\",false,false] spawn life_fnc_MP;","\t\tplayer setPos (getMarkerPos \"jail_release\");","\t\t[5] call SOCK_fnc_updatePartial;","\t};","};"]},{"start":{"row":0,"column":0},"end":{"row":106,"column":2},"action":"insert","lines":["/*","\tFile: fn_jailMe.sqf","\tAuthor Bryan \"Tonic\" Boardwine","\t","\tDescription:","\tOnce word is received by the server the rest of the jail execution is completed.","*/","private[\"_ret\",\"_bad\",\"_time\",\"_bail\",\"_esc\",\"_countDown\",\"_time\"];","_ret = [_this,0,[],[[]]] call BIS_fnc_param;","_bad = [_this,1,false,[false]] call BIS_fnc_param;","_time = [_this,2,15,[0]] call BIS_fnc_param; //##80","","_time = time + (_time * 60); //x Minutes","","//if(_bad) then { _time = time + 1100; } else { _time = time + (15 * 60); }; //##80 (time loaded from DB)","","if(count _ret > 0) then { life_bail_amount = (_ret select 3); } else { life_bail_amount = 20000; /*_time = time + (10 * 60); */};","_esc = false;","_bail = false;","","if(_time <= 0) then { _time = time + (15 * 60); hintC \"Please Report to Admin: JAIL_FALLBACK_15, time is zero!\"; };","","[_bad,_time] spawn","{","\tlife_canpay_bail = false;","\tlife_bail_amount = life_bail_amount * 5;","\tif(_this select 0) then","\t{","\t\t//sleep (10 * 60);","\t\t//50% of time","\t\tsleep ( (_this select 1) * 0.5 );","\t}","\t\telse","\t{","\t\t//sleep (5 * 60);","\t\t//20% of time","\t\tsleep ( (_this select 1) * 0.2 );","\t};","\tlife_canpay_bail = nil;","};","","while {true} do","{","\tif((round(_time - time)) > 0) then","\t{","\t\t_countDown = if(round (_time - time) > 60) then {format[\"%1 minute(s)\",round(round(_time - time) / 60)]} else {format[\"%1 second(s)\",round(_time - time)]};","\t\tif(isNil \"life_canpay_bail\") then","\t\t{","\t\t\thintSilent format[\"Time Remaining:\\n %1\\n\\nCan pay Bail: %3\\nBail Amount: $%2\",_countDown,[life_bail_amount] call life_fnc_numberText];","\t\t}","\t\telse","\t\t{","\t\t\thintSilent format[\"Time Remaining:\\n %1\\n\",_countDown];","\t\t};","\t\t","\t};","\t","\tif(player distance (getMarkerPos \"jail_marker\") > 180) exitWith","\t{","\t\t_esc = true;","\t};","\t","\tif(life_bail_paid) exitWith","\t{","\t\t_bail = true;","\t};","\t","\tif((round(_time - time)) < 1) exitWith {hint \"\"};","\tif(!alive player && ((round(_time - time)) > 0)) exitWith","\t{","\t","\t};","\tsleep 1;","};","","","switch (true) do","{","\tcase (_bail) :","\t{","\t\tlife_is_arrested = false;","\t\tlife_bail_paid = false;","\t\thint localize \"STR_Jail_Paid\";","\t\tserv_wanted_remove = [player];","\t\tplayer setPos (getMarkerPos \"jail_release\");","\t\t[[getPlayerUID player],\"life_fnc_wantedRemove\",false,false] spawn life_fnc_MP;","\t\t[5] call SOCK_fnc_updatePartial;","\t};","\t","\tcase (_esc) :","\t{","\t\tlife_is_arrested = false;","\t\thint localize \"STR_Jail_EscapeSelf\";","\t\t[[0,format[\"%1 has escaped from jail!\",profileName]],\"life_fnc_broadcast\",nil,false] spawn life_fnc_MP;","\t\t[[getPlayerUID player,profileName,\"901\"],\"life_fnc_wantedAdd\",false,false] spawn life_fnc_MP;","\t\t[5] call SOCK_fnc_updatePartial;","\t};","\t","\tcase (alive player && !_esc && !_bail) :","\t{","\t\tlife_is_arrested = false;","\t\thint localize \"STR_Jail_Released\";","\t\t[[getPlayerUID player],\"life_fnc_wantedRemove\",false,false] spawn life_fnc_MP;","\t\tplayer setPos (getMarkerPos \"jail_release\");","\t\t[5] call SOCK_fnc_updatePartial;","\t};","};"]}]}]]},"ace":{"folds":[],"scrolltop":0,"scrollleft":0,"selection":{"start":{"row":106,"column":2},"end":{"row":106,"column":2},"isBackwards":false},"options":{"guessTabSize":true,"useWrapMode":false,"wrapToView":true},"firstLineState":{"row":1,"state":"start","mode":"ace/mode/text"}},"timestamp":1421494454547,"hash":"3e5440c3f51ae651a50f70a3545df581859d7b39"}